---
import { Icon } from "astro-icon/components";
---

<section
  class="2x:w-[200px] 2x:h-[200px] flex h-[calc(50dvw-32px)] max-w-[200px] min-w-full flex-col justify-between gap-2 overflow-hidden rounded-2xl p-4 duration-200"
>
  <h1 class="font-hachimaru 2x:text-xl flex text-lg font-bold">
    晴れときどき<br />崩壊ブログ
  </h1>
  <p class="2x:block mb-4 hidden text-xs">
    技術と日常を綴る<br />備忘録なのです
  </p>
  <div class="flex justify-end gap-2">
    <button id="theme-toggle" class="cursor-pointer hover:scale-95">
      <Icon name="tabler:sun" class="h-8 w-8" />
    </button>
    <a
      href="https://github.com/OJII3"
      target="_blank"
      rel="noopener noreferrer"
      class="cursor-pointer hover:scale-95"
    >
      <Icon name="tabler:brand-github-filled" class="h-8 w-8" />
    </a>
  </div>
</section>

<script type="text/partytown">
  const theme = (() => {
    const localStorageTheme = localStorage?.getItem("theme") ?? "";
    if (["dark", "light"].includes(localStorageTheme)) {
      return localStorageTheme;
    }
    if (window.matchMedia("(prefers-color-scheme: dark)").matches) {
      return "dark";
    }
    return "light";
  })();

  if (theme === "light") {
    document.documentElement.classList.remove("dark");
  } else {
    document.documentElement.classList.add("dark");
  }

  window.localStorage.setItem("theme", theme);

  const handleToggleClick = () => {
    const element = document.documentElement;
    element.classList.toggle("dark");

    const isDark = element.classList.contains("dark");
    localStorage.setItem("theme", isDark ? "dark" : "light");
  };

  document
    .getElementById("theme-toggle")
    ?.addEventListener("click", handleToggleClick);
</script>
