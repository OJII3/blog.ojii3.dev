---
import "../_styles/override.css";
import { type CollectionEntry, render } from "astro:content";
import { CODE_COLORS, SITE_NAME, SITE_URL } from "../../../constants";
import GlobalLayout from "../../_layouts/GlobalLayout.astro";
import PostHeader from "../_components/PostHeader.astro";
import PostPrevNext from "../_components/PostPrevNext.astro";

// import Header from "@/components/Header.astro";
// import Footer from "@/components/Footer.astro";
// import Tag from "@/components/Tag.astro";
// import Datetime from "@/components/Datetime.astro";
// import EditPost from "@/components/EditPost.astro";
// import ShareLinks from "@/components/ShareLinks.astro";
// import BackButton from "@/components/BackButton.astro";
// import BackToTopButton from "@/components/BackToTopButton.astro";
// import { slugifyStr } from "@/utils/slugify";
// import IconChevronLeft from "@/assets/icons/IconChevronLeft.svg";
// import IconChevronRight from "@/assets/icons/IconChevronRight.svg";

export interface Props {
	prevPost: CollectionEntry<"blog"> | null;
	nextPost: CollectionEntry<"blog"> | null;
	post: CollectionEntry<"blog">;
}

const { post, prevPost, nextPost } = Astro.props;

const { title, dateString, color, tags } = post.data;

const { Content } = await render(post);

const titleText = `${title} | ${SITE_NAME}`;
const ogImage = `${SITE_URL}/${post.id}/og-image.png`;
---

<GlobalLayout title={titleText} ogImage={ogImage}>
  <div class="max-w-[80ch] mx-auto">

    <PostHeader color={color} />

    <main
      transition:name={post.id}
      class="w-full p-4"
      data-pagefind-body
    >
      <h1 class="mt-4 text-2xl font-bold sm:text-3xl">
        {title}
      </h1>

      <div class="mt-2 mb-8 flex items-center gap-2">
        <span aria-hidden="true" class="text-sm"
          >{dateString}</span
        >
      </div>

      <article class:list={["prose dark:prose-invert mx-auto max-w-none overflow-hidden prose-code:rounded-xs prose-code:px-1", CODE_COLORS[color]]}>
        <Content />
      </article>

      <ul class="mt-4 mb-8 sm:my-8">
        <!-- {tags.map((tag) => <Tag tag={slugifyStr(tag)} tagName={tag} />)} -->
      </ul>

      <div data-pagefind-ignore="all" class="grid grid-cols-1 gap-4 pt-8 pb-4 sm:grid-cols-2">
        {
          prevPost ? <PostPrevNext originalPost={post} targetPost={prevPost} isPrev /> : <div></div>
        }
        {
          nextPost ? <PostPrevNext originalPost={post} targetPost={nextPost} isNext /> : <div></div>
        }
      </div>
    </main>
  </div>
  <!-- <Footer /> -->
</GlobalLayout>
