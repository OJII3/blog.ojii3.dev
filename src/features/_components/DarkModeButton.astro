---
export interface Props {
	class?: string;
}

const { class: className } = Astro.props;
---

<button
  id="theme-toggle"
  class:list={["cursor-pointer hover:scale-95", className]}
  aria-label="Toggle theme"
>
  <slot />
</button>

<script is:inline>
  const handleToggleClick = () => {
    const element = document.documentElement;
    element.classList.toggle("dark");

    const isDark = element.classList.contains("dark");
    localStorage.setItem("theme", isDark ? "dark" : "light");
  };

  const attachListener = () => {
    document
      .getElementById("theme-toggle")
      ?.addEventListener("click", handleToggleClick);
  };

  // 初回ロード時
  attachListener();

  // View Transitions でのページ遷移時
  document.addEventListener("astro:page-load", attachListener);
</script>
